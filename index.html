<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cardastika</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;500;600;700&family=Forum&family=UnifrakturCook:wght@700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="styles/global.css" />
  <link rel="stylesheet" href="assets/css/ui-shell.css" />
  <link rel="stylesheet" href="pages/auth/auth.css" />
</head>

<body>
  <div id="app" class="app">
    <!-- ============ MAIN SCREEN ============ -->
    <main id="mainScreen" class="screen" style="display: none;">

      <!-- HUD -->
      <header id="hud" class="hud">
        <div class="hud__left">
          <div class="hud__avatar">
            <img id="hudAvatar" alt="Avatar" src="">
          </div>
          <span class="hud__icon hud__icon--swords" id="hudSword" aria-hidden="true"></span>
          <span class="hud__value" id="hudPower">-</span>
        </div>

        <div class="hud__right">
          <div class="hud__pill hud__pill--silver" title="Silver">
            <span class="hud__value" id="hudSilver">-</span>
            <img class="hud__currency-icon" src="assets/icons/coin-silver.svg" alt="">
          </div>
          <div class="hud__pill hud__pill--diamonds" title="Diamonds" style="display:none">
            <span class="hud__value" id="hudDiamonds">-</span>
            <img class="hud__currency-icon" src="assets/icons/diamond.svg" alt="">
          </div>
          <div class="hud__pill hud__pill--gold" title="Gold">
            <span class="hud__value" id="hudGold">-</span>
            <img class="hud__currency-icon" src="assets/icons/coin-gold.svg" alt="">
          </div>
        </div>
      </header>
      <script>
        // Встановити аватар з localStorage одразу (до завантаження ui-shell.js)
        (function() {
          var img = document.getElementById("hudAvatar");
          var saved = localStorage.getItem("cardastika:avatarUrl");
          if (img && saved && saved.startsWith("assets/")) {
            img.src = saved;
          } else if (img) {
            img.src = "assets/cards/arts/fire_001.webp";
          }
        })();
      </script>

      <!-- 2x3 tiles -->
      <section class="tiles">
        <a class="tile tile--duel" href="pages/duel/duel.html">
          <span class="tile__rune rune rune--sword rune--glow"></span>
          <div class="tile__art"></div>
          <div class="tile__label">Дуелі: <b>10</b></div>
        </a>

        <a class="tile tile--campaign" href="pages/campaign/campaign.html">
          <span class="tile__rune rune rune--raidho rune--glow"></span>
          <div class="tile__art"></div>
          <div class="tile__label">Кампанія</div>
        </a>

        <a class="tile tile--arena" href="pages/arena/arena.html">
          <span class="tile__rune rune rune--shield rune--glow"></span>
          <div class="tile__art"></div>
          <div class="tile__label">Арена</div>
        </a>

        <a class="tile tile--tournament" href="pages/arena/tournament.html">
          <span class="tile__rune rune rune--crown rune--glow"></span>
          <div class="tile__art"></div>
          <div class="tile__label">Турнір</div>
        </a>

        <a class="tile tile--deck" href="pages/deck/deck.html">
          <span class="tile__rune rune rune--algiz rune--glow"></span>
          <div class="tile__art"></div>
          <div class="tile__label">
            <span id="tileDeckName">Бойова колода</span>
            <b class="tile__deck-power"><span class="hud__icon hud__icon--swords" aria-hidden="true"></span><span id="tileDeckPower">180</span></b>
          </div>
        </a>

        <a class="tile tile--invasion" href="pages/invasion/invasion.html">
          <span class="tile__rune rune rune--flame rune--glow rune--red"></span>
          <div class="tile__art"></div>
          <div class="tile__label">Нашестя Урфіна</div>
        </a>
      </section>

      <!-- list menu -->
      <section class="menu-list">
        <a class="menu-item" href="pages/tasks/tasks.html">
          <span class="menu-item__icon">📌</span>
          <span class="menu-item__text">Завдання</span>
        </a>

        <a class="menu-item" href="pages/battlepass/battlepass.html">
          <span class="menu-item__icon">💎</span>
          <span class="menu-item__text">Алмазні нагороди</span>
        </a>

        <a class="menu-item" href="pages/equipment/equipment.html">
          <span class="menu-item__icon">🧰</span>
          <span class="menu-item__text">Спорядження</span>
        </a>

        <a class="menu-item" href="pages/collections/collections.html">
          <span class="menu-item__icon">📚</span>
          <span class="menu-item__text">Колекції</span>
        </a>

        <a class="menu-item" href="pages/shop/shop.html">
          <span class="menu-item__icon">🛒</span>
          <span class="menu-item__text">Крамниця</span>
        </a>

        <a class="menu-item menu-item--gold" href="pages/shop/buy-gold.html">
          <img class="menu-item__icon" src="assets/icons/coin-gold.svg" alt="Gold" />
          <span class="menu-item__text">Купити золото</span>
        </a>
      </section>

    </main>

    <div id="toastHost" class="toast-host" aria-live="polite"></div>
    <div id="modalHost" class="modal-host" aria-hidden="true"></div>

    <!-- Botbar (3 кнопки) -->
    <nav id="botbar" class="botbar botbar--3" aria-label="Bottom navigation" style="display: none;">
      <button class="botbar__btn" data-route="home" type="button">
        <span class="botbar__icon" aria-hidden="true"></span>
        <span class="botbar__text">Головна</span>
      </button>

      <button class="botbar__btn" data-route="profile" type="button">
        <span class="botbar__icon" aria-hidden="true"></span>
        <span class="botbar__text">Профіль</span>
      </button>

      <button class="botbar__btn" data-route="guild" type="button">
        <span class="botbar__icon" aria-hidden="true"></span>
        <span class="botbar__text">Гільдія</span>
      </button>
    </nav>

  </div>

  <script type="module">
    const TUTORIAL_COMPLETED_KEY = "cardastika:tutorialCompleted";
    const TUTORIAL_STAGE_KEY = "cardastika:tutorialStage";
    const AUTH_ACTIVE_KEY = "cardastika:auth:active";

    const tutorialDone = localStorage.getItem(TUTORIAL_COMPLETED_KEY) === "1";
    const tutorialStage = localStorage.getItem(TUTORIAL_STAGE_KEY);
    const activeAuth = localStorage.getItem(AUTH_ACTIVE_KEY);

    if (!tutorialDone) {
      if (!activeAuth) {
        window.location.href = "pages/tutorial/tutorial-auth.html";
      } else if (tutorialStage === "duel") {
        window.location.href = "pages/duel/duel.html?tutorial=1";
      } else if (tutorialStage === "upgrade") {
        window.location.href = "pages/deck/deck.html?tutorial=1";
      } else if (tutorialStage === "buy") {
        window.location.href = "pages/shop/shop.html?tutorial=1";
      } else if (tutorialStage === "tasks") {
        window.location.href = "pages/tasks/tasks.html?tutorial=complete";
      } else {
        window.location.href = "pages/tutorial/tutorial.html";
      }
    } else {
      if (!localStorage.getItem("cardastika:player") && activeAuth) {
        localStorage.setItem("cardastika:player", activeAuth);
      }

      const userSession = localStorage.getItem("cardastika:player");
      if (!userSession) {
        window.location.href = "pages/auth/auth.html";
      } else {
        const mainScreen = document.getElementById("mainScreen");
        const botbar = document.getElementById("botbar");
        if (mainScreen) mainScreen.style.display = "block";
        if (botbar) botbar.style.display = "grid";
      }
    }
  </script>
  <script type="module" defer src="src/ui-shell.js"></script>
</body>
</html>







